<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Case Studies - AndanteFit</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    .report-list { max-width: 900px; margin: 0 auto; border-top: 2px solid var(--color-deep-blue); }
    .report-item { display: flex; align-items: center; padding: 20px 0; border-bottom: 1px solid var(--color-soft-gray); transition: background-color 0.2s; }
    .report-item:hover { background-color: #fcfcfc; }
    .report-date { width: 130px; font-size: 0.9rem; color: var(--color-text-muted); flex-shrink: 0; }
    .report-main { flex-grow: 1; padding: 0 20px; }
    .report-title { font-size: 1.1rem; font-weight: 600; color: var(--color-deep-blue); margin: 0; display: flex; align-items: center; gap: 10px; }
    .lang-badge { font-size: 0.7rem; background-color: #f1f5f9; color: #475569; padding: 2px 8px; border-radius: 4px; font-weight: 700; border: 1px solid #e2e8f0; }
    .btn-small { padding: 8px 16px; font-size: 0.85rem; border-radius: 6px; white-space: nowrap; }
    @media (max-width: 768px) { .report-item { flex-direction: column; align-items: flex-start; } .report-date { margin-bottom: 8px; } .report-main { padding: 0 0 15px 0; } }
  </style>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-0L4ENVHFYP"></script>
  <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-0L4ENVHFYP');</script>
</head>
<body>
  <nav class="nav">
    <div class="nav-container">
      <a href="index.html" class="nav-logo"><img src="assets/andantefit-logo.png" alt="AndanteFit"></a>
      <ul class="nav-menu" id="navMenu">
        <li><a href="index.html" class="nav-link">Home</a></li>
        <li><a href="product.html" class="nav-link">Product</a></li>
        <li><a href="validation.html" class="nav-link">Validation</a></li>
        <li><a href="case-studies.html" class="nav-link active">Case Studies</a></li>
        <li><a href="references.html" class="nav-link">References</a></li>
      </ul>
      <button class="nav-toggle" id="navToggle">☰</button>
    </div>
  </nav>

  <section class="hero">
    <div class="container hero-content">
      <span class="section-label">Research Reports</span>
      <h1 class="hero-headline">Case Studies</h1>
      <p class="hero-subtitle">Real-world implementations of AndanteFit across clinical and research settings.</p>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div id="caseStudiesContainer" class="report-list">
        <p style="text-align: center; color: var(--color-text-muted); padding: 40px;">Loading reports...</p>
      </div>
    </div>
  </section>

  <!-- Standard Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h4>AndanteFit</h4>
          <p>Developed and provided by DYPHI Inc.<br>Automated physical performance assessment for frailty and sarcopenia research.</p>
        </div>
        <div class="footer-section">
          <h4>Quick Links</h4>
          <p><a href="product.html">Product</a><br><a href="validation.html">Validation</a><br><a href="case-studies.html">Case Studies</a></p>
        </div>
        <div class="footer-section">
          <h4>Contact</h4>
          <p>Email: <a href="mailto:snm@dyphi.com">snm@dyphi.com</a></p>
        </div>
      </div>
      <div class="footer-bottom">© 2026 DYPHI Inc. All Rights Reserved.</div>
    </div>
  </footer>

  <script src="js/main.js"></script>
  <script>
    const GITHUB_CONFIG = { owner: 'jjgitson', repo: 'andantefit.info', folder: 'case-studies', branch: 'main' };
    
    // 한국어 제목 매핑 테이블
    const koreanTitles = {
      'PRO-SPPB-Linking-Study': '자기보고 기반 신체기능(PRO)과 SPPB 공통 해석 기준',
      'Digital-Care-Platform': '디지털 복지관 중심 예방적 건강관리 플랫폼',
      'Common-Operational-Language-Strategy': '노인 통합 돌봄을 위한 공통 운영 언어 구축 전략',
      'SPPB-Occupational-Health': 'SPPB 활용한 직업 건강 관리'
    };

    function parseFilename(f) {
      const m = f.match(/^(\d{4})-(\d{2})-(\d{2})-(.+)\.html$/);
      if (m) {
        const fileKey = m[4]; // 날짜 제외한 파일명 키
        const defaultTitle = m[4].replace(/-/g, ' ');
        
        return { 
          date: new Date(m[1], m[2]-1, m[3]), 
          dateStr: `${m[1]}.${m[2]}.${m[3]}`, 
          title: koreanTitles[fileKey] || defaultTitle, // 매핑된 한국어 제목 우선 사용
          filename: f,
          fileKey: fileKey
        };
      }
      console.warn('Invalid filename format:', f);
      return { 
        date: new Date(0), 
        dateStr: '----.--.--', 
        title: f.replace('.html', '').replace(/-/g, ' '), 
        filename: f,
        fileKey: f
      };
    }

    async function loadCaseStudies() {
      const container = document.getElementById('caseStudiesContainer');
      try {
        const res = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.owner}/${GITHUB_CONFIG.repo}/contents/${GITHUB_CONFIG.folder}`);
        const files = await res.json();
        const htmlFiles = files.filter(f => f.type === 'file' && f.name.endsWith('.html'));
        const caseStudies = htmlFiles.map(f => ({ ...parseFilename(f.name), url: `case-studies/${f.name}` })).sort((a,b) => b.date - a.date);
        
        container.innerHTML = caseStudies.map(s => {
          // 한국어 제목이 매핑된 경우 또는 제목에 한글이 포함된 경우
          const isKorean = koreanTitles[s.fileKey] || /[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/.test(s.title);
          
          const badge = isKorean ? '<span class="lang-badge">한국어</span>' : '';
          return `<div class="report-item">
                    <div class="report-date">${s.dateStr}</div>
                    <div class="report-main"><h3 class="report-title">${s.title} ${badge}</h3></div>
                    <div class="report-link"><a href="${s.url}" class="btn btn-primary btn-small">View Report →</a></div>
                  </div>`;
        }).join('');
      } catch (e) { 
        console.error('Error loading case studies:', e);
        container.innerHTML = '<p>Error loading reports.</p>'; 
      }
    }
    
    loadCaseStudies();
  </script>
</body>
</html>
