<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Case Studies - AndanteFit</title>
  <meta name="description" content="AndanteFit 케이스 스터디: 임상 및 연구 현장에서의 실제 적용 사례와 리포트">
  <meta name="keywords" content="AndanteFit, 케이스 스터디, 사례 연구, 임상 적용, 연구 리포트, SPPB, 신체기능평가, 노쇠, 근감소증">
  <meta name="author" content="DYPHI Inc.">
  <meta property="og:locale" content="ko_KR">
  <meta property="og:type" content="website">
  <meta property="og:title" content="Case Studies - AndanteFit">
  <meta property="og:description" content="AndanteFit 케이스 스터디: 임상 및 연구 현장에서의 실제 적용 사례와 리포트">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Case Studies - AndanteFit">
  <meta name="twitter:description" content="AndanteFit 케이스 스터디: 임상 및 연구 현장에서의 실제 적용 사례와 리포트">
  <link rel="stylesheet" href="css/style.css">
  <style>
    .report-list { max-width: 900px; margin: 0 auto; border-top: 2px solid var(--color-deep-blue); }
    .report-item { display: flex; align-items: center; padding: 20px 0; border-bottom: 1px solid var(--color-soft-gray); transition: background-color 0.2s; }
    .report-item:hover { background-color: #fcfcfc; }
    .report-date { width: 130px; font-size: 0.9rem; color: var(--color-text-muted); flex-shrink: 0; }
    .report-main { flex-grow: 1; padding: 0 20px; }
    .report-title { font-size: 1.1rem; font-weight: 600; color: var(--color-deep-blue); margin: 0; display: flex; align-items: center; gap: 10px; }
    .lang-badge { font-size: 0.7rem; background-color: #f1f5f9; color: #475569; padding: 2px 8px; border-radius: 4px; font-weight: 700; border: 1px solid #e2e8f0; }
    .btn-small { padding: 8px 16px; font-size: 0.85rem; border-radius: 6px; white-space: nowrap; }
    @media (max-width: 768px) { .report-item { flex-direction: column; align-items: flex-start; } .report-date { margin-bottom: 8px; } .report-main { padding: 0 0 15px 0; } }
  </style>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-0L4ENVHFYP"></script>
  <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-0L4ENVHFYP');</script>
</head>
<body>
  <nav class="nav">
    <div class="nav-container">
      <a href="index.html" class="nav-logo"><img src="assets/andantefit-logo.png" alt="AndanteFit"></a>
      <ul class="nav-menu" id="navMenu">
        <li><a href="index.html" class="nav-link">Home</a></li>
        <li><a href="product.html" class="nav-link">Product</a></li>
        <li><a href="validation.html" class="nav-link">Validation</a></li>
        <li><a href="case-studies.html" class="nav-link active">Case Studies</a></li>
        <li><a href="references.html" class="nav-link">References</a></li>
      </ul>
      <button class="nav-toggle" id="navToggle">☰</button>
    </div>
  </nav>

  <section class="hero">
    <div class="container hero-content">
      <span class="section-label">연구 리포트</span>
      <h1 class="hero-headline">Case Studies</h1>
      <p class="hero-subtitle">임상 및 연구 현장에서의 AndanteFit 실제 적용 사례를 정리했습니다.</p>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div id="caseStudiesContainer" class="report-list">
        <p style="text-align: center; color: var(--color-text-muted); padding: 40px;">리포트를 불러오는 중입니다...</p>
      </div>
    </div>
  </section>

  <!-- Standard Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h4>AndanteFit</h4>
  <p>
  DYPHI Inc.에서 개발 및 제공<br>
  임상과 지역사회 환경에서 활용되는 전자동 신체기능 평가 솔루션.
</p>
        </div>
        <div class="footer-section">
          <h4>Quick Links</h4>
          <p><a href="product.html">Product</a><br><a href="validation.html">Validation</a><br><a href="case-studies.html">Case Studies</a></p>
        </div>
           <div class="footer-section">
          <h4>Contact</h4>
                <p>
            이메일: <a href="mailto:snm@dyphi.com">snm@dyphi.com</a><br>
           서울: 서울특별시 송파구 법원로11길 25 A-509<br>
            대전: 대전광역시 유성구 대학로 99 C17
          </p>
        </div>
      </div>
      <div class="footer-bottom">© 2026 DYPHI Inc. All Rights Reserved.</div>
    </div>
  </footer>


<script src="js/main.js"></script>
<script>
(function() {
    'use strict';
    
    // ==================== 설정 ====================
    const GITHUB_CONFIG = { 
        owner: 'jjgitson', 
        repo: 'andantefit.info', 
        folder: 'case-studies', 
        branch: 'main'
    };
    

    
    const koreanTitles = {
        'PRO-SPPB-Linking-Study': '자기보고 기반 신체기능(PRO)과 SPPB 공통 해석 기준',
        'Digital-Care-Platform': '디지털 복지관 중심 예방적 건강관리 플랫폼',
       'CIBERFES-Consensus-Frailty-Screening-KR': 'CIBERFES 프레일티 컨센서스',
    };
    
    const englishTitles = {
        'SPPB-Occupational-Health': 'SPPB Utilization in Occupational Health',
        'Common-Operational-Language-Strategy': 'Strategic Proposal: Seamless Integrated Care for Older Adults'
    };
    
    const CACHE_KEY = 'case_studies_cache';
    const CACHE_DURATION = 24 * 60 * 60 * 1000; // 24시간
    
    // ==================== 헬퍼 함수 ====================
    function parseFilename(filename) {
        const match = filename.match(/^(\d{4})-(\d{2})-(\d{2})-(.+)\.html$/);
        
        if (!match) {
            return { 
                date: new Date(0), 
                dateStr: '----.--.--', 
                title: filename.replace('.html', '').replace(/-/g, ' '), 
                filename: filename,
                fileKey: filename
            };
        }
        
        const [, year, month, day, fileKey] = match;
        const defaultTitle = fileKey.replace(/-/g, ' ');
        const title = spanishTitles[fileKey] || koreanTitles[fileKey] || englishTitles[fileKey] || defaultTitle;
        
        return { 
            date: new Date(year, month - 1, day), 
            dateStr: `${year}.${month}.${day}`, 
            title: title,
            filename: filename,
            fileKey: fileKey
        };
    }
    
    function renderCaseStudies(container, caseStudies) {
        if (!container) {
            console.error('Container element not found');
            return;
        }
        
        const html = caseStudies.map(function(study) {
            const isKorean = koreanTitles.hasOwnProperty(study.fileKey);
            const isSpanish = spanishTitles.hasOwnProperty(study.fileKey);
            const badge = isKorean ? '<span class="lang-badge">한국어</span>' : 
                         isSpanish ? '<span class="lang-badge">Español</span>' : '';
            
            return `<div class="report-item">
                        <div class="report-date">${study.dateStr}</div>
                        <div class="report-main">
                            <h3 class="report-title">
                                <a href="${study.url}" class="title-link">${study.title}</a> ${badge}
                            </h3>
                        </div>
                        <div class="report-link">
                            <a href="${study.url}" class="btn btn-primary btn-small">Ver Informe →</a>
                        </div>
                    </div>`;
        }).join('');
        
        container.innerHTML = html;
    }
    
    function showError(container, message) {
        container.innerHTML = `<div style="color: #dc2626; padding: 20px; background: #fee2e2; border-radius: 8px; border-left: 4px solid #dc2626;">
            <strong>Error al cargar los informes</strong><br>
            ${message}<br>
            <small style="color: #991b1b; margin-top: 8px; display: block;">
                Por favor, actualice la página en unos minutos.
            </small>
        </div>`;
    }
    
    function showCacheWarning(container) {
        container.insertAdjacentHTML('afterbegin', 
            `<div style="background: #fef3c7; padding: 12px; border-radius: 8px; margin-bottom: 20px; font-size: 14px; border-left: 4px solid #f59e0b;">
                ⚠️ Mostrando datos en caché. La actualización está temporalmente limitada.
            </div>`
        );
    }
    
    // ==================== 메인 함수 ====================
    async function loadCaseStudies() {
        const container = document.getElementById('caseStudiesContainer');
        
        if (!container) {
            console.error('Container #caseStudiesContainer not found');
            return;
        }
        
        try {
            // 1. 캐시 확인
            const cached = localStorage.getItem(CACHE_KEY);
            const cacheTime = localStorage.getItem(CACHE_KEY + '_time');
            
            if (cached && cacheTime) {
                const age = Date.now() - parseInt(cacheTime);
                
                // 캐시가 유효하면 바로 사용
                if (age < CACHE_DURATION) {
                    console.log('✓ Using valid cache (age: ' + Math.floor(age / 1000 / 60) + ' minutes)');
                    const caseStudies = JSON.parse(cached);
                    renderCaseStudies(container, caseStudies);
                    return;
                }
            }
            
            // 2. API 호출
            console.log('→ Fetching from GitHub API...');
            const response = await fetch(
                `https://api.github.com/repos/${GITHUB_CONFIG.owner}/${GITHUB_CONFIG.repo}/contents/${GITHUB_CONFIG.folder}`
            );
            
            // 3. API 실패 처리
            if (!response.ok) {
                console.warn('API returned status:', response.status);
                
                // 캐시가 있으면 만료되었어도 사용
                if (cached) {
                    console.log('⚠ Using expired cache due to API failure');
                    const caseStudies = JSON.parse(cached);
                    renderCaseStudies(container, caseStudies);
                    showCacheWarning(container);
                    return;
                }
                
                throw new Error('API request failed with status ' + response.status);
            }
            
            // 4. 데이터 파싱
            const data = await response.json();
            
            if (!Array.isArray(data)) {
                throw new Error('Invalid API response format');
            }
            
            console.log('✓ API response received:', data.length, 'items');
            
            // 5. HTML 파일 필터링
            const htmlFiles = data.filter(function(file) {
                return file.type === 'file' && file.name.endsWith('.html');
            });
            
            console.log('✓ Found', htmlFiles.length, 'HTML files');
            
            // 6. 파싱 및 정렬
            const caseStudies = htmlFiles
                .map(function(file) {
                    const parsed = parseFilename(file.name);
                    parsed.url = 'case-studies/' + file.name;
                    return parsed;
                })
                .sort(function(a, b) {
                    return b.date - a.date;
                });
            
            // 7. 캐시 저장
            localStorage.setItem(CACHE_KEY, JSON.stringify(caseStudies));
            localStorage.setItem(CACHE_KEY + '_time', Date.now().toString());
            console.log('✓ Cache updated');
            
            // 8. 렌더링
            renderCaseStudies(container, caseStudies);
            console.log('✓ Case studies loaded successfully');
            
        } catch (error) {
            console.error('Error loading case studies:', error);
            showError(container, error.message);
        }
    }
    
    // ==================== 실행 ====================
    // DOM 로드 확인 후 실행
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadCaseStudies);
    } else {
        loadCaseStudies();
    }
})();
</script>
</body>
</html>
